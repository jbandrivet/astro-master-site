<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Astro Master – Profil & Générateur</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
    background: #000;
    color: #e8e8e8;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image:
      radial-gradient(circle at 5% 8%, rgba(0,255,0,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 18%, rgba(0,255,0,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 28%, rgba(0,180,255,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 38%, rgba(0,255,0,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 48%, rgba(0,255,0,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 58%, rgba(0,180,255,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 68%, rgba(0,255,0,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 78%, rgba(0,180,255,0.6) 2px, transparent 2px),
      radial-gradient(circle at 5% 88%, rgba(0,255,0,0.6) 2px, transparent 2px),
      repeating-linear-gradient(90deg, transparent 0px, transparent 3px, rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 4px),
      repeating-linear-gradient(0deg, 
        #0a0a0a 0px, 
        #1a1a1a 100px,
        #252525 100px,
        #252525 103px,
        #0f0f0f 103px,
        #0f0f0f 106px
      ),
      linear-gradient(135deg, #0d0d0d 25%, transparent 25%),
      linear-gradient(225deg, #0d0d0d 25%, transparent 25%),
      linear-gradient(45deg, #0d0d0d 25%, transparent 25%),
      linear-gradient(315deg, #0d0d0d 25%, #1a1a1a 25%);
    background-size: 
      100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%,
      5px 100%,
      100% 106px,
      20px 20px, 20px 20px, 20px 20px, 20px 20px;
    background-position: 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 0 0, 10px 0, 10px 10px, 0 10px;
    z-index: 0;
    animation: ledPulse 4s ease-in-out infinite;
  }

  @keyframes ledPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.95; }
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  header {
    text-align: center;
    margin-bottom: 60px;
    padding: 40px 20px;
    background: linear-gradient(135deg, rgba(0,180,255,0.05) 0%, rgba(0,255,0,0.05) 100%);
    border-radius: 20px;
    border: 1px solid rgba(0,180,255,0.3);
    box-shadow: 
      0 0 40px rgba(0,180,255,0.2),
      inset 0 1px 0 rgba(255,255,255,0.1);
    position: relative;
  }

  header::before {
    content: '●';
    position: absolute;
    top: 20px;
    right: 30px;
    color: #00ff00;
    font-size: 20px;
    text-shadow: 0 0 20px #00ff00;
    animation: blink 2s ease-in-out infinite;
  }

  @keyframes blink {
    0%, 49%, 100% { opacity: 1; }
    50%, 99% { opacity: 0.2; }
  }

  h1 {
    font-size: 48px;
    font-weight: 800;
    background: linear-gradient(135deg, #00b4ff 0%, #00ff88 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 10px;
    text-shadow: 0 0 40px rgba(0,180,255,0.5);
  }

  @media (max-width: 768px) {
    h1 {
      font-size: 32px;
    }
  }

  .tagline {
    font-size: 18px;
    color: #a0a0a0;
    font-weight: 300;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  @media (max-width: 768px) {
    .tagline {
      font-size: 14px;
      letter-spacing: 1px;
    }
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin-bottom: 40px;
  }

  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
    }
  }

  .server-card {
    background: linear-gradient(180deg, rgba(25,25,25,0.98) 0%, rgba(15,15,15,0.98) 100%);
    border: 2px solid rgba(60,60,60,0.8);
    border-left: 4px solid rgba(0,180,255,0.4);
    border-radius: 3px;
    padding: 30px;
    box-shadow: 
      0 4px 20px rgba(0,0,0,0.9),
      inset 0 1px 0 rgba(255,255,255,0.03),
      inset 0 -1px 0 rgba(0,0,0,0.5);
    position: relative;
    transition: all 0.3s ease;
  }

  .server-card::before {
    content: '';
    position: absolute;
    left: 8px;
    top: 15px;
    bottom: 15px;
    width: 3px;
    background: repeating-linear-gradient(
      0deg,
      rgba(0,180,255,0.3) 0px,
      rgba(0,180,255,0.3) 8px,
      transparent 8px,
      transparent 12px
    );
  }

  .server-card:hover {
    transform: translateY(-2px);
    box-shadow: 
      0 6px 30px rgba(0,0,0,0.95),
      inset 0 1px 0 rgba(255,255,255,0.05),
      inset 0 -1px 0 rgba(0,0,0,0.5);
    border-left-color: rgba(0,180,255,0.7);
  }

  .server-card::after {
    content: '';
    position: absolute;
    top: 15px;
    right: 15px;
    width: 8px;
    height: 8px;
    background: #00ff00;
    border-radius: 50%;
    box-shadow: 
      0 0 10px #00ff00, 
      0 0 20px rgba(0,255,0,0.3),
      inset 0 1px 2px rgba(255,255,255,0.3);
    animation: pulse 3s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(0.8); }
  }

  .server-card.full {
    grid-column: 1 / -1;
  }

  h2 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #00b4ff;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  h2::before {
    content: '';
    width: 4px;
    height: 24px;
    background: linear-gradient(180deg, #00b4ff 0%, #00ff88 100%);
    border-radius: 2px;
  }

  .badges {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }

  .badge {
    background: rgba(0,180,255,0.15);
    border: 1px solid rgba(0,180,255,0.4);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    color: #00b4ff;
    transition: all 0.2s ease;
    cursor: pointer;
    position: relative;
  }

  .badge:hover {
    background: rgba(0,180,255,0.25);
    border-color: rgba(0,180,255,0.6);
    transform: scale(1.05);
  }

  .badge.active {
    background: rgba(0,180,255,0.35);
    border-color: rgba(0,180,255,0.9);
    box-shadow: 0 0 15px rgba(0,180,255,0.4);
  }

  .kink-explanation {
    margin-top: 15px;
    margin-bottom: 15px;
    padding: 15px 20px;
    background: rgba(0,0,0,0.5);
    border-left: 3px solid #00b4ff;
    border-radius: 8px;
    display: none;
  }

  .kink-explanation.show {
    display: block;
    animation: slideDown 0.3s ease;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .kink-explanation h3 {
    color: #00ff88;
    font-size: 16px;
    margin-bottom: 8px;
    font-weight: 600;
  }

  .kink-explanation p {
    color: #c0c0c0;
    font-size: 14px;
    line-height: 1.6;
  }

  .about-text {
    line-height: 1.8;
    color: #c0c0c0;
    font-size: 15px;
  }

  .form-group {
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin-bottom: 8px;
    color: #a0a0a0;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  input, select, textarea {
    width: 100%;
    background: rgba(0,0,0,0.5);
    border: 1px solid rgba(0,180,255,0.3);
    padding: 14px 18px;
    border-radius: 10px;
    color: #e8e8e8;
    font-size: 15px;
    transition: all 0.3s ease;
    font-family: inherit;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #00b4ff;
    background: rgba(0,0,0,0.7);
    box-shadow: 0 0 20px rgba(0,180,255,0.3);
  }

  select {
    cursor: pointer;
  }

  .roles-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
    margin-top: 10px;
  }

  .role-checkbox {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    background: rgba(0,0,0,0.5);
    border: 2px solid rgba(0,180,255,0.3);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .role-checkbox:hover {
    border-color: rgba(0,180,255,0.5);
    background: rgba(0,180,255,0.1);
  }

  .role-checkbox input[type="checkbox"] {
    width: 20px;
    height: 20px;
    margin-right: 10px;
    cursor: pointer;
    accent-color: #00b4ff;
  }

  .role-checkbox.checked {
    border-color: #00b4ff;
    background: rgba(0,180,255,0.2);
  }

  .role-checkbox span {
    color: #c0c0c0;
    font-size: 14px;
    font-weight: 500;
  }

  .role-checkbox.checked span {
    color: #00ff88;
    font-weight: 600;
  }

  button {
    width: 100%;
    background: linear-gradient(135deg, #00b4ff 0%, #0088cc 100%);
    border: none;
    padding: 16px;
    border-radius: 10px;
    color: #fff;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 5px 20px rgba(0,180,255,0.4);
  }

  button:hover {
    background: linear-gradient(135deg, #0088cc 0%, #00b4ff 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0,180,255,0.6);
  }

  button:active {
    transform: translateY(0);
  }

  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .whatsapp-btn {
    background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    text-decoration: none;
    margin-top: 15px;
    padding: 16px;
    border-radius: 10px;
    color: #fff;
    font-size: 16px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 5px 20px rgba(37, 211, 102, 0.4);
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
  }

  .whatsapp-btn:hover {
    background: linear-gradient(135deg, #128C7E 0%, #25D366 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(37, 211, 102, 0.6);
  }

  #result {
    margin-top: 30px;
    padding: 25px;
    background: rgba(0,0,0,0.6);
    border: 1px solid rgba(0,255,0,0.3);
    border-radius: 12px;
    display: none;
  }

  #result.show {
    display: block;
    animation: slideIn 0.5s ease;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #contract {
    white-space: pre-line;
    line-height: 1.8;
    color: #d0d0d0;
    font-size: 14px;
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    border-left: 3px solid #00b4ff;
  }

  canvas {
    display: block;
    margin: 20px auto;
    border-radius: 50%;
    box-shadow: 0 0 40px rgba(0,180,255,0.5);
    border: 3px solid rgba(0,180,255,0.5);
  }

  .download-buttons {
    display: flex;
    gap: 15px;
    margin-top: 20px;
  }

  .download-buttons button {
    flex: 1;
    background: linear-gradient(135deg, #00ff88 0%, #00b4ff 100%);
  }

  .download-buttons button:hover {
    background: linear-gradient(135deg, #00b4ff 0%, #00ff88 100%);
  }

  footer {
    text-align: center;
    padding: 40px 20px;
    margin-top: 60px;
    border-top: 1px solid rgba(0,180,255,0.2);
  }

  .contact-info {
    display: flex;
    justify-content: center;
    gap: 40px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }

  .contact-item {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #a0a0a0;
    font-size: 14px;
  }

  .contact-item a {
    color: #00b4ff;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .contact-item a:hover {
    color: #00ff88;
  }

  .copyright {
    color: #666;
    font-size: 13px;
    margin-top: 20px;
  }

  .photo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin-top: 20px;
  }

  .photo-upload-btn {
    background: rgba(0,0,0,0.5);
    border: 2px dashed rgba(0,180,255,0.4);
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    color: #a0a0a0;
  }

  .photo-upload-btn:hover {
    border-color: rgba(0,180,255,0.7);
    background: rgba(0,180,255,0.1);
  }

  .photo-upload-btn span {
    font-size: 40px;
    display: block;
    margin-bottom: 10px;
  }

  .error-message {
    color: #ff4444;
    font-size: 13px;
    margin-top: 5px;
    display: none;
  }

  .error-message.show {
    display: block;
  }

  .loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
    margin-left: 10px;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ASTRO MASTER</h1>
      <p class="tagline">Dominant • Technologie • Astronomie • Fétichiste du cou</p>
    </header>

    <div class="grid">
      <div class="server-card">
        <h2>👤 À propos</h2>
        <p class="about-text">
          Passionné par la technologie et l'immensité de l'univers, je recherche des relations basées sur la confiance, le respect mutuel et la clarté des rôles.
        </p>
      </div>

      <div class="server-card">
        <h2>⚡ Centres d'intérêt</h2>
        <div class="badges">
          <span class="badge">Informatique</span>
          <span class="badge">Serveurs</span>
          <span class="badge">Astronomie</span>
          <span class="badge">Astrophysique</span>
        </div>
        <p class="about-text">
          Passionné de systèmes informatiques avec une fascination pour l'observation des étoiles et l'exploration spatiale.
        </p>
      </div>

      <div class="server-card full">
        <h2>🔥 Kinks & Pratiques</h2>
        <div class="badges">
          <span class="badge" data-kink="dominant">Dominant actif</span>
          <span class="badge" data-kink="pony">Pony play</span>
          <span class="badge" data-kink="puppy">Puppy play</span>
          <span class="badge" data-kink="majordome">Majordome</span>
          <span class="badge" data-kink="cou">Fétichiste du cou</span>
          <span class="badge" data-kink="foot">Foot Slave</span>
          <span class="badge" data-kink="black">Black de compagnie (raceplay)</span>
          <span class="badge" data-kink="bougnoule">Bougnoule de compagnie (raceplay)</span>
          <span class="badge" data-kink="garde">Garde du corps</span>
          <span class="badge" data-kink="bear">Bear de compagnie</span>
          <span class="badge" data-kink="gorge">Gorge profonde</span>
        </div>

        <div style="margin-top: 20px; padding: 15px; background: rgba(255,0,0,0.1); border-left: 4px solid #ff0000; border-radius: 8px;">
          <h3 style="color: #ff4444; font-size: 16px; margin-bottom: 10px; font-weight: 600;">⚠️ Limites non négociables</h3>
          <p style="color: #ffaaaa; font-size: 14px; line-height: 1.6;">
            • Drogues<br>
            • Alcool<br>
            • Pratiques anales
          </p>
        </div>

        <div id="kinkExplanation" class="kink-explanation">
          <h3 id="kinkTitle"></h3>
          <p id="kinkDescription"></p>
        </div>

        <p class="about-text">
          Relations D/s basées sur le consentement mutuel et le respect des limites. Particulièrement attiré par la beauté et l'élégance du cou.
        </p>
      </div>

      <div class="server-card full">
        <h2>💬 Me contacter</h2>
        <p class="about-text" style="margin-bottom: 15px;">
          Pour toute question ou discussion, contactez-moi directement sur WhatsApp.
        </p>
        <a href="https://wa.me/33783204184" class="whatsapp-btn" target="_blank" rel="noopener noreferrer">
          <span>📱</span>
          Ouvrir WhatsApp
        </a>
      </div>

      <div class="server-card full">
        <h2>📸 Envoyez vos photos du cou</h2>
        <p class="about-text" style="margin-bottom: 20px;">
          Je serais ravi de recevoir vos photos du cou sous différents angles (face, profil gauche, profil droit). Cliquez sur les zones ci-dessous pour prendre et m'envoyer vos photos.
        </p>
        <div class="photo-grid">
          <div class="photo-upload-btn" onclick="captureNeckPhoto('face')" role="button" tabindex="0" aria-label="Prendre photo du cou de face">
            <span>📷</span>
            <div>Face</div>
          </div>
          <div class="photo-upload-btn" onclick="captureNeckPhoto('profil gauche')" role="button" tabindex="0" aria-label="Prendre photo du cou profil gauche">
            <span>📷</span>
            <div>Profil Gauche</div>
          </div>
          <div class="photo-upload-btn" onclick="captureNeckPhoto('profil droit')" role="button" tabindex="0" aria-label="Prendre photo du cou profil droit">
            <span>📷</span>
            <div>Profil Droit</div>
          </div>
        </div>
      </div>

      <div class="server-card full">
        <h2>🎖️ Générateur de macaron d'appartenance</h2>
        <form id="generatorForm">
          <div class="form-group">
            <label for="prenom">Prénom</label>
            <input type="text" id="prenom" placeholder="Entrez votre prénom" required maxlength="50" autocomplete="given-name">
            <div class="error-message" id="prenomError">Le prénom ne doit contenir que des lettres, espaces et tirets</div>
          </div>

          <div class="form-group">
            <label for="nom">Nom</label>
            <input type="text" id="nom" placeholder="Entrez votre nom" required maxlength="50" autocomplete="family-name">
            <div class="error-message" id="nomError">Le nom ne doit contenir que des lettres, espaces et tirets</div>
          </div>

          <div class="form-group">
            <label>Rôle(s) - Sélectionnez un ou plusieurs rôles</label>
            <div class="roles-container">
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Majordome">
                <span>Majordome</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Poney">
                <span>Poney</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Puppy">
                <span>Puppy</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Larbin">
                <span>Larbin</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Esclave du cou">
                <span>Esclave du cou</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Foot Slave">
                <span>Foot Slave</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Black de compagnie">
                <span>Black de compagnie</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Bougnoule de compagnie">
                <span>Bougnoule de compagnie</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Garde du corps/Agent de sécurité">
                <span>Garde du corps/Agent de sécurité</span>
              </label>
              <label class="role-checkbox">
                <input type="checkbox" name="role" value="Bear de compagnie">
                <span>Bear de compagnie</span>
              </label>
            </div>
            <div class="error-message" id="roleError">Veuillez sélectionner au moins un rôle</div>
          </div>

          <button type="submit" id="submitBtn">Générer le macaron</button>
        </form>

        <div id="result">
          <div id="contract"></div>
          <canvas id="logo" width="250" height="250"></canvas>
          <div class="download-buttons">
            <button onclick="downloadPDF()">📄 Télécharger PDF</button>
            <button onclick="downloadJPEG()">🖼️ Télécharger JPEG</button>
          </div>
        </div>
      </div>
    </div>

    <input type="file" id="neckPhotoInput" accept="image/*" capture="environment" style="display: none;">

    <footer>
      <div class="contact-info">
        <div class="contact-item">
          <span>📧</span>
          <a href="mailto:jeanbaptisteandrivet@gmail.com">jeanbaptisteandrivet@gmail.com</a>
        </div>
        <div class="contact-item">
          <span>📱</span>
          <a href="tel:+33783204184">+33 7 83 20 41 84</a>
        </div>
      </div>
      <div class="copyright">
        © 2025 Astro Master • Tous droits réservés
      </div>
    </footer>
  </div>

  <script>
    let currentContractText = '';
    let currentPrenom = '';
    let currentNom = '';
    let currentRoles = [];
    let currentNeckPhotoAngle = '';

    const kinkDefinitions = {
      dominant: {
        title: "Dominant actif",
        description: "Rôle de leader dans une relation D/s (Domination/soumission). Le dominant guide, décide et prend en charge la relation tout en respectant les limites établies avec son partenaire soumis."
      },
      pony: {
        title: "Pony Play",
        description: "Pratique où le soumis incarne un poney. Cela peut inclure le port d'équipement (harnais, mors), l'entraînement, et diverses activités équestres adaptées au contexte BDSM."
      },
      puppy: {
        title: "Puppy Play",
        description: "Jeu de rôle où le soumis adopte le comportement d'un chiot. Cela inclut des aspects ludiques, affectueux et de dressage, avec parfois l'utilisation d'accessoires comme colliers ou oreilles."
      },
      majordome: {
        title: "Majordome",
        description: "Rôle de service domestique raffiné. Le soumis assure diverses tâches avec élégance et professionnalisme : entretien, organisation, service à table, et autres responsabilités domestiques."
      },
      cou: {
        title: "Fétichiste du cou",
        description: "Attirance particulière pour le cou, sa forme, ses lignes, sa courbure. Appréciation esthétique de cette partie du corps, de sa grâce et de son élégance."
      },
      foot: {
        title: "Foot Slave",
        description: "Rôle de soumission centré sur les pieds du dominant. Cela peut inclure massage, adoration, soin des pieds, et autres formes de service dédiées à cette partie du corps."
      },
      black: {
        title: "Black de compagnie (raceplay)",
        description: "Jeu de rôle consensuel explorant des dynamiques de pouvoir liées à l'identité afro-descendante dans un contexte BDSM. Cette pratique implique un cadre de service et de soumission basé sur des stéréotypes raciaux retournés de manière érotique, nécessitant une communication claire, des limites strictes et un respect absolu entre partenaires consentants."
      },
      bougnoule: {
        title: "Bougnoule de compagnie (raceplay)",
        description: "Jeu de rôle consensuel explorant des dynamiques de pouvoir liées aux origines maghrébines/arabes dans un contexte BDSM. Cette pratique implique un cadre de service et de soumission basé sur des stéréotypes raciaux retournés de manière érotique, nécessitant une communication claire, des limites strictes et un respect absolu entre partenaires consentants."
      },
      garde: {
        title: "Garde du corps",
        description: "Rôle de protection et de service. Le soumis assure la sécurité physique et émotionnelle du dominant, fait preuve de vigilance et se tient prêt à intervenir si nécessaire."
      },
      bear: {
        title: "Bear de compagnie",
        description: "Jeu de rôle consensuel explorant des dynamiques basées sur l'archétype du 'bear' (homme poilu, corpulent, masculin). Cette pratique implique un cadre de service et de soumission, avec une appréciation particulière des caractéristiques physiques associées à cette identité."
      },
      gorge: {
        title: "Gorge profonde",
        description: "Pratique où le dominant apprécie recevoir une fellation profonde. Cela nécessite une confiance mutuelle, une communication claire sur les limites et le confort du partenaire soumis."
      }
    };

    window.addEventListener('DOMContentLoaded', function() {
      const kinkBadges = document.querySelectorAll('.badge[data-kink]');
      const explanationDiv = document.getElementById('kinkExplanation');
      const titleEl = document.getElementById('kinkTitle');
      const descEl = document.getElementById('kinkDescription');
      
      kinkBadges.forEach(function(badge) {
        badge.addEventListener('click', function() {
          const kinkKey = this.getAttribute('data-kink');
          const kinkData = kinkDefinitions[kinkKey];
          const wasActive = this.classList.contains('active');
          
          kinkBadges.forEach(function(b) {
            b.classList.remove('active');
          });
          
          if (wasActive) {
            explanationDiv.classList.remove('show');
          } else {
            this.classList.add('active');
            titleEl.textContent = kinkData.title;
            descEl.textContent = kinkData.description;
            explanationDiv.classList.add('show');
          }
        });
      });

      document.querySelectorAll('.role-checkbox').forEach(function(label) {
        label.addEventListener('click', function(e) {
          if (e.target.tagName !== 'INPUT') {
            const checkbox = this.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
          }
          this.classList.toggle('checked', this.querySelector('input[type="checkbox"]').checked);
          document.getElementById('roleError').classList.remove('show');
        });
      });
    });

    function captureNeckPhoto(angle) {
      currentNeckPhotoAngle = angle;
      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      
      if (isMobile && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        const input = document.getElementById('neckPhotoInput');
        input.click();
      } else {
        sendNeckPhotoViaWhatsApp(angle);
      }
    }

    document.getElementById('neckPhotoInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        handleNeckPhotoShare(file, currentNeckPhotoAngle);
      }
      e.target.value = '';
    });

    function handleNeckPhotoShare(file, angle) {
      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      
      if (isMobile && navigator.share) {
        const fileName = 'Cou_' + angle + '_' + new Date().getTime() + '.jpg';
        const shareFile = new File([file], fileName, { type: file.type });
        
        navigator.share({
          files: [shareFile],
          title: 'Photo du cou - ' + angle,
          text: 'Photo du cou (' + angle + ') pour Astro Master'
        }).then(function() {
          console.log('Photo partagée avec succès');
        }).catch(function(error) {
          console.log('Partage annulé ou erreur:', error);
          sendNeckPhotoViaWhatsApp(angle);
        });
      } else {
        sendNeckPhotoViaWhatsApp(angle);
      }
    }

    function sendNeckPhotoViaWhatsApp(angle) {
      const message = 'Bonjour Astro Master, je souhaite vous envoyer une photo de mon cou (' + angle + ')';
      const whatsappUrl = 'https://wa.me/33783204184?text=' + encodeURIComponent(message);
      window.open(whatsappUrl, '_blank');
    }

    function validateName(name) {
      const nameRegex = /^[a-zA-ZÀ-ÿ\s-]+$/;
      return nameRegex.test(name);
    }

    function sanitizeInput(input) {
      return input.trim().replace(/[<>]/g, '');
    }

    document.getElementById('prenom').addEventListener('input', function(e) {
      const errorDiv = document.getElementById('prenomError');
      if (e.target.value && !validateName(e.target.value)) {
        errorDiv.classList.add('show');
      } else {
        errorDiv.classList.remove('show');
      }
    });

    document.getElementById('nom').addEventListener('input', function(e) {
      const errorDiv = document.getElementById('nomError');
      if (e.target.value && !validateName(e.target.value)) {
        errorDiv.classList.add('show');
      } else {
        errorDiv.classList.remove('show');
      }
    });

    document.getElementById('generatorForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const prenomInput = document.getElementById('prenom').value.trim();
      const nomInput = document.getElementById('nom').value.trim();
      
      const selectedRoles = Array.from(document.querySelectorAll('input[name="role"]:checked'))
        .map(function(checkbox) { return checkbox.value; });

      if (!validateName(prenomInput)) {
        document.getElementById('prenomError').classList.add('show');
        return;
      }

      if (!validateName(nomInput)) {
        document.getElementById('nomError').classList.add('show');
        return;
      }

      if (selectedRoles.length === 0) {
        document.getElementById('roleError').classList.add('show');
        return;
      }

      currentPrenom = sanitizeInput(prenomInput);
      currentNom = sanitizeInput(nomInput);
      currentRoles = selectedRoles;

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'Génération en cours...<span class="loading"></span>';

      setTimeout(function() {
        const rolesText = currentRoles.length === 1 
          ? currentRoles[0] 
          : currentRoles.slice(0, -1).join(', ') + ' et ' + currentRoles[currentRoles.length - 1];

        let engagements = '• Servir avec dévouement et respect\n';
        engagements += '• Honorer les règles établies d\'un commun accord\n';
        engagements += '• Maintenir une communication claire et honnête\n';
        engagements += '• Respecter les limites convenues\n';

        if (currentRoles.includes('Majordome')) {
          engagements += '• Assurer un service domestique impeccable et raffiné\n';
          engagements += '• Maintenir l\'ordre et l\'organisation du foyer\n';
        }
        if (currentRoles.includes('Poney') || currentRoles.includes('Puppy')) {
          engagements += '• Me conformer aux entraînements et exercices demandés\n';
          engagements += '• Porter l\'équipement approprié avec fierté\n';
        }
        if (currentRoles.includes('Esclave du cou')) {
          engagements += '• Prendre soin de mon cou et le présenter avec élégance\n';
          engagements += '• Accepter l\'attention portée à cette partie de mon corps\n';
        }
        if (currentRoles.includes('Foot Slave')) {
          engagements += '• Assurer le soin et l\'adoration des pieds de mon Maître\n';
          engagements += '• Effectuer massages et entretien avec dévotion\n';
        }
        if (currentRoles.includes('Black de compagnie') || currentRoles.includes('Bougnoule de compagnie')) {
          engagements += '• Accepter le cadre du raceplay avec ses codes spécifiques\n';
          engagements += '• Communiquer clairement sur mes limites dans ce contexte\n';
        }
        if (currentRoles.includes('Garde du corps/Agent de sécurité')) {
          engagements += '• Assurer la sécurité et la protection de mon Maître\n';
          engagements += '• Rester vigilant et disponible en toutes circonstances\n';
        }
        if (currentRoles.includes('Bear de compagnie')) {
          engagements += '• Embrasser mon identité bear dans le cadre de la relation\n';
          engagements += '• Accepter l\'appréciation de mes caractéristiques physiques\n';
        }
        if (currentRoles.includes('Larbin')) {
          engagements += '• Effectuer toutes les tâches demandées avec diligence\n';
          engagements += '• Me tenir à disposition pour tout service requis\n';
        }

        currentContractText = 'CONTRAT D\'APPARTENANCE\n\nJe soussigné(e) ' + currentPrenom + ' ' + currentNom + ', reconnais officiellement mon rôle en tant que ' + rolesText + ' d\'Astro Master.\n\nJe m\'engage à :\n' + engagements + '\nCe contrat est basé sur le consentement mutuel, le respect et la confiance.\n\nSigné : ' + currentPrenom + ' ' + currentNom + '\nDate : ' + new Date().toLocaleDateString('fr-FR');

        document.getElementById('contract').textContent = currentContractText;

        generateLogo();

        document.getElementById('result').classList.add('show');
        
        submitBtn.disabled = false;
        submitBtn.innerHTML = 'Générer le macaron';

        setTimeout(function() {
          document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
      }, 800);
    });

    function generateLogo() {
      const canvas = document.getElementById('logo');
      const ctx = canvas.getContext('2d');
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const gradient = ctx.createLinearGradient(0, 0, 250, 250);
      gradient.addColorStop(0, '#00b4ff');
      gradient.addColorStop(1, '#00ff88');
      
      ctx.beginPath();
      ctx.arc(125, 125, 115, 0, 2 * Math.PI);
      ctx.fillStyle = '#0a0a0a';
      ctx.fill();
      ctx.strokeStyle = gradient;
      ctx.lineWidth = 8;
      ctx.stroke();

      ctx.beginPath();
      ctx.arc(125, 125, 100, 0, 2 * Math.PI);
      ctx.strokeStyle = 'rgba(0,180,255,0.3)';
      ctx.lineWidth = 2;
      ctx.stroke();

      ctx.fillStyle = '#00b4ff';
      ctx.font = 'bold 20px Inter, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('ASTRO MASTER', 125, 70);

      ctx.fillStyle = '#00ff88';
      if (currentRoles.length === 1) {
        ctx.font = 'bold 22px Inter, sans-serif';
        const roleText = currentRoles[0].toUpperCase();
        if (roleText.length > 20) {
          ctx.font = 'bold 18px Inter, sans-serif';
        }
        ctx.fillText(roleText, 125, 125);
      } else {
        ctx.font = 'bold 16px Inter, sans-serif';
        let yPos = 105;
        currentRoles.forEach(function(role, index) {
          const roleText = role.toUpperCase();
          if (roleText.length > 25) {
            ctx.font = 'bold 13px Inter, sans-serif';
          }
          ctx.fillText(roleText, 125, yPos + (index * 20));
        });
      }

      ctx.fillStyle = '#e8e8e8';
      ctx.font = '16px Inter, sans-serif';
      const yOffset = currentRoles.length > 1 ? 105 + (currentRoles.length * 20) + 20 : 160;
      ctx.fillText(currentPrenom + ' ' + currentNom, 125, yOffset);

      ctx.fillStyle = '#888';
      ctx.font = '12px Inter, sans-serif';
      ctx.fillText(new Date().toLocaleDateString('fr-FR'), 125, yOffset + 25);
    }

    function downloadPDF() {
      try {
        const jsPDF = window.jspdf.jsPDF;
        const doc = new jsPDF();

        doc.setFontSize(20);
        doc.setFont(undefined, 'bold');
        doc.text('CONTRAT D\'APPARTENANCE', 105, 20, { align: 'center' });

        doc.setFontSize(12);
        doc.setFont(undefined, 'normal');
        
        const lines = currentContractText.split('\n');
        let yPos = 40;
        
        lines.forEach(function(line) {
          if (line.trim()) {
            const splitLines = doc.splitTextToSize(line, 170);
            splitLines.forEach(function(splitLine) {
              doc.text(splitLine, 20, yPos);
              yPos += 7;
            });
          } else {
            yPos += 5;
          }
        });

        const canvas = document.getElementById('logo');
        const imgData = canvas.toDataURL('image/jpeg', 1.0);
        doc.addImage(imgData, 'JPEG', 70, yPos + 10, 70, 70);

        const pdfBlob = doc.output('blob');
        const fileName = 'Contrat_' + currentPrenom + '_' + currentNom + '.pdf';
        
        if (navigator.share && navigator.canShare) {
          const file = new File([pdfBlob], fileName, { type: 'application/pdf' });
          
          if (navigator.canShare({ files: [file] })) {
            navigator.share({
              files: [file],
              title: 'Contrat d\'appartenance',
              text: 'Contrat généré par Astro Master'
            }).catch(function(err) {
              if (err.name !== 'AbortError') {
                console.log('Erreur de partage:', err);
              }
              fallbackDownload(pdfBlob, fileName);
            });
            return;
          }
        }
        
        fallbackDownload(pdfBlob, fileName);
      } catch (error) {
        console.error('Erreur lors de la génération du PDF:', error);
        alert('Une erreur est survenue lors de la génération du PDF. Veuillez réessayer.');
      }
    }

    function downloadJPEG() {
      try {
        const canvas = document.getElementById('logo');
        const fileName = 'Macaron_' + currentPrenom + '_' + currentNom + '.jpg';
        
        canvas.toBlob(function(blob) {
          if (navigator.share && navigator.canShare) {
            const file = new File([blob], fileName, { type: 'image/jpeg' });
            
            if (navigator.canShare({ files: [file] })) {
              navigator.share({
                files: [file],
                title: 'Macaron d\'appartenance',
                text: 'Macaron généré par Astro Master'
              }).catch(function(err) {
                if (err.name !== 'AbortError') {
                  console.log('Erreur de partage:', err);
                }
                fallbackDownload(blob, fileName);
              });
              return;
            }
          }
          
          fallbackDownload(blob, fileName);
        }, 'image/jpeg', 1.0);
      } catch (error) {
        console.error('Erreur lors du téléchargement JPEG:', error);
        alert('Une erreur est survenue lors du téléchargement. Veuillez réessayer.');
      }
    }

    function fallbackDownload(blob, fileName) {
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = fileName;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      setTimeout(function() {
        URL.revokeObjectURL(url);
      }, 100);
    }
  </script>
</body>
</html>
